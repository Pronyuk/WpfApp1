è
6C:\Users\Nuke\Source\Repos\WpfApp1\WpfApp1\App.xaml.cs
	namespace		 	
WpfApp1		
 
{

 
public 

partial 
class 
App 
: 
Application *
{ 
} 
} €
:C:\Users\Nuke\Source\Repos\WpfApp1\WpfApp1\AssemblyInfo.cs
[ 
assembly 	
:	 

	ThemeInfo 
( &
ResourceDictionaryLocation 
. 
None #
,# $&
ResourceDictionaryLocation 
. 
SourceAssembly -
)

 
]

 ˆ∆
=C:\Users\Nuke\Source\Repos\WpfApp1\WpfApp1\MainWindow.xaml.cs
	namespace 	
WpfApp1
 
{ 
public 

partial 
class 

MainWindow #
:$ %
Window& ,
{ 
public 

MainWindow 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
ShowDesktopWindows!! 
(!! 
)!!  
;!!  !#
ScreenConnectionMonitor$$ #
.$$# $%
OnScreenConnectionChanged$$$ =
+=$$> @
($$A B
)$$B C
=>$$D F
{%% 
}// 
;// #
ScreenConnectionMonitor11 #
.11# $
Start11$ )
(11) *
)11* +
;11+ ,
}55 	
private77 
List77 
<77 
string77 
>77 
ShowDesktopWindows77 /
(77/ 0
)770 1
{88 	
List99 
<99 
IntPtr99 
>99 
handles99  
;99  !
List:: 
<:: 
string:: 
>:: 
titles:: 
;::  
EnumWindows;; 
.;; ,
 GetDesktopWindowHandlesAndTitles;; 8
(;;8 9
out;;9 <
handles;;= D
,;;D E
out;;F I
titles;;J P
);;P Q
;;;Q R
titles== 
.== 
ForEach== 
(== 
v== 
=>== 
{>> 
Trace?? 
.?? 
	WriteLine?? 
(??  
v??  !
)??! "
;??" #
}@@ 
)@@ 
;@@ 
returnBB 
titlesBB 
;BB 
}CC 	
publicEE 
voidEE 
GetWMIDisplayInfoEE %
(EE% &
)EE& '
{FF 	
varGG 
queryGG 
=GG 
$strGG 4
;GG4 5
usingHH 
(HH 
varHH 
wmiHH 
=HH 
newHH  
SystemHH! '
.HH' (

ManagementHH( 2
.HH2 3$
ManagementObjectSearcherHH3 K
(HHK L
$strHHL Y
,HHY Z
queryHH[ `
)HH` a
)HHa b
{II 
varJJ 
resultsJJ 
=JJ 
wmiJJ !
.JJ! "
GetJJ" %
(JJ% &
)JJ& '
;JJ' (
foreachKK 
(KK 
varKK 
itemKK !
inKK" $
resultsKK% ,
)KK, -
{LL 
TraceMM 
.MM 
	WriteLineMM #
(MM# $
itemMM$ (
.MM( )
GetTextMM) 0
(MM0 1
SystemMM1 7
.MM7 8

ManagementMM8 B
.MMB C

TextFormatMMC M
.MMM N
MofMMN Q
)MMQ R
)MMR S
;MMS T
varNN 
tempNN 
=NN 
newNN "!
WmiDisplayInformationNN# 8
(NN8 9
)NN9 :
;NN: ;
tempPP 
.PP 
ActivePP 
=PP  !
(PP" #
boolPP# '
)PP' (
itemPP( ,
[PP, -
$strPP- 5
]PP5 6
;PP6 7
tempQQ 
.QQ 
InstanceNameQQ %
=QQ& '
(QQ( )
stringQQ) /
)QQ/ 0
itemQQ0 4
[QQ4 5
$strQQ5 C
]QQC D
;QQD E
tempRR 
.RR 
ManufacturerNameRR )
=RR* +
(RR, -
(RR- .
ushortRR. 4
[RR4 5
]RR5 6
)RR6 7
itemRR7 ;
[RR; <
$strRR< N
]RRN O
)RRO P
.RRP Q
WhereRRQ V
(RRV W
vRRW X
=>RRY [
vRR\ ]
!=RR^ `
$numRRa b
)RRb c
.RRc d
ToArrayRRd k
(RRk l
)RRl m
;RRm n
tempSS 
.SS 
ProductCodeIDSS &
=SS' (
(SS) *
(SS* +
ushortSS+ 1
[SS1 2
]SS2 3
)SS3 4
itemSS4 8
[SS8 9
$strSS9 H
]SSH I
)SSI J
.SSJ K
WhereSSK P
(SSP Q
vSSQ R
=>SSS U
vSSV W
!=SSX Z
$numSS[ \
)SS\ ]
.SS] ^
ToArraySS^ e
(SSe f
)SSf g
;SSg h
tempTT 
.TT 
SerialNumberIDTT '
=TT( )
(TT* +
(TT+ ,
ushortTT, 2
[TT2 3
]TT3 4
)TT4 5
itemTT5 9
[TT9 :
$strTT: J
]TTJ K
)TTK L
.TTL M
WhereTTM R
(TTR S
vTTS T
=>TTU W
vTTX Y
!=TTZ \
$numTT] ^
)TT^ _
.TT_ `
ToArrayTT` g
(TTg h
)TTh i
;TTi j
tempUU 
.UU 
UserFriendlyNameUU )
=UU* +
(UU, -
(UU- .
ushortUU. 4
[UU4 5
]UU5 6
)UU6 7
itemUU7 ;
[UU; <
$strUU< N
]UUN O
)UUO P
.UUP Q
WhereUUQ V
(UUV W
vUUW X
=>UUY [
vUU\ ]
!=UU^ `
$numUUa b
)UUb c
.UUc d
ToArrayUUd k
(UUk l
)UUl m
;UUm n
tempVV 
.VV "
UserFriendlyNameLengthVV /
=VV0 1
(VV2 3
intVV3 6
)VV6 7
(VV7 8
ushortVV8 >
)VV> ?
itemVV? C
[VVC D
$strVVD \
]VV\ ]
;VV] ^
tempWW 
.WW 
WeekOfManufactureWW *
=WW+ ,
(WW- .
intWW. 1
)WW1 2
(WW2 3
byteWW3 7
)WW7 8
itemWW8 <
[WW< =
$strWW= P
]WWP Q
;WWQ R
tempXX 
.XX 
YearOfManufactureXX *
=XX+ ,
(XX- .
intXX. 1
)XX1 2
(XX2 3
ushortXX3 9
)XX9 :
itemXX: >
[XX> ?
$strXX? R
]XXR S
;XXS T
TraceZZ 
.ZZ 
	WriteLineZZ #
(ZZ# $
tempZZ$ (
.ZZ( )
ToStringZZ) 1
(ZZ1 2
)ZZ2 3
)ZZ3 4
;ZZ4 5
}[[ 
}\\ 
}]] 	
private__ 
void__ 
button_Click__ !
(__! "
object__" (
sender__) /
,__/ 0
RoutedEventArgs__1 @
e__A B
)__B C
{`` 	
varaa 
textaa 
=aa 
ShowDesktopWindowsaa )
(aa) *
)aa* +
;aa+ ,
thisbb 
.bb  
textBox_DisplaysInfobb %
.bb% &
Textbb& *
=bb+ ,
textbb- 1
.bb1 2
	Aggregatebb2 ;
(bb; <
(bb< =
ibb= >
,bb> ?
jbb@ A
)bbA B
=>bbC E
ibbF G
+bbH I
$"bbJ L
{bbL M
EnvironmentbbM X
.bbX Y
NewLinebbY `
}bb` a
"bba b
+bbc d
jbbe f
)bbf g
;bbg h
}cc 	
}dd 
publicff 

classff !
WmiDisplayInformationff &
{gg 
publichh 
boolhh 
Activehh 
{hh 
gethh  
;hh  !
sethh" %
;hh% &
}hh' (
publicjj 
stringjj 
InstanceNamejj "
{jj# $
getjj% (
;jj( )
setjj* -
;jj- .
}jj/ 0
publicll 
ushortll 
[ll 
]ll 
ManufacturerNamell (
{ll) *
getll+ .
;ll. /
setll0 3
;ll3 4
}ll5 6
publicnn 
ushortnn 
[nn 
]nn 
ProductCodeIDnn %
{nn& '
getnn( +
;nn+ ,
setnn- 0
;nn0 1
}nn2 3
publicpp 
ushortpp 
[pp 
]pp 
SerialNumberIDpp &
{pp' (
getpp) ,
;pp, -
setpp. 1
;pp1 2
}pp3 4
publicrr 
ushortrr 
[rr 
]rr 
UserFriendlyNamerr (
{rr) *
getrr+ .
;rr. /
setrr0 3
;rr3 4
}rr5 6
publictt 
inttt "
UserFriendlyNameLengthtt )
{tt* +
gettt, /
;tt/ 0
settt1 4
;tt4 5
}tt6 7
publicvv 
intvv 
WeekOfManufacturevv $
{vv% &
getvv' *
;vv* +
setvv, /
;vv/ 0
}vv1 2
publicxx 
intxx 
YearOfManufacturexx $
{xx% &
getxx' *
;xx* +
setxx, /
;xx/ 0
}xx1 2
publiczz 
overridezz 
stringzz 
ToStringzz '
(zz' (
)zz( )
{{{ 	
var}} 
manuf}} 
=}} 
ManufacturerName}} (
.}}( )
Select}}) /
(}}/ 0
v}}0 1
=>}}2 4
Convert}}5 <
.}}< =
ToChar}}= C
(}}C D
v}}D E
)}}E F
)}}F G
.}}G H
ToArray}}H O
(}}O P
)}}P Q
;}}Q R
var~~ 
productC~~ 
=~~ 
ProductCodeID~~ (
.~~( )
Select~~) /
(~~/ 0
v~~0 1
=>~~2 4
Convert~~5 <
.~~< =
ToChar~~= C
(~~C D
v~~D E
)~~E F
)~~F G
.~~G H
ToArray~~H O
(~~O P
)~~P Q
;~~Q R
var 
serialNumberID 
=  
SerialNumberID! /
./ 0
Select0 6
(6 7
v7 8
=>9 ;
Convert< C
.C D
ToCharD J
(J K
vK L
)L M
)M N
.N O
ToArrayO V
(V W
)W X
;X Y
var
ÄÄ 
userFriendlyName
ÄÄ  
=
ÄÄ! "
UserFriendlyName
ÄÄ# 3
.
ÄÄ3 4
Select
ÄÄ4 :
(
ÄÄ: ;
v
ÄÄ; <
=>
ÄÄ= ?
Convert
ÄÄ@ G
.
ÄÄG H
ToChar
ÄÄH N
(
ÄÄN O
v
ÄÄO P
)
ÄÄP Q
)
ÄÄQ R
.
ÄÄR S
ToArray
ÄÄS Z
(
ÄÄZ [
)
ÄÄ[ \
;
ÄÄ\ ]
var
ÅÅ 
sb
ÅÅ 
=
ÅÅ 
new
ÅÅ 
StringBuilder
ÅÅ &
(
ÅÅ& '
)
ÅÅ' (
;
ÅÅ( )
sb
ÇÇ 
.
ÇÇ 

AppendLine
ÇÇ 
(
ÇÇ 
$"
ÇÇ 
Active: 
ÇÇ $
{
ÇÇ$ %
Active
ÇÇ% +
}
ÇÇ+ ,
"
ÇÇ, -
)
ÇÇ- .
;
ÇÇ. /
sb
ÉÉ 
.
ÉÉ 

AppendLine
ÉÉ 
(
ÉÉ 
$"
ÉÉ 
InstanceName: 
ÉÉ *
{
ÉÉ* +
InstanceName
ÉÉ, 8
}
ÉÉ8 9
"
ÉÉ9 :
)
ÉÉ: ;
;
ÉÉ; <
sb
ÑÑ 
.
ÑÑ 

AppendLine
ÑÑ 
(
ÑÑ 
$"
ÑÑ  
ManufacturerName: 
ÑÑ .
{
ÑÑ. /
new
ÑÑ0 3
string
ÑÑ4 :
(
ÑÑ: ;
manuf
ÑÑ; @
)
ÑÑ@ A
}
ÑÑB C
"
ÑÑC D
)
ÑÑD E
;
ÑÑE F
sb
ÖÖ 
.
ÖÖ 

AppendLine
ÖÖ 
(
ÖÖ 
$"
ÖÖ 
SerialNumberID: 
ÖÖ ,
{
ÖÖ, -
new
ÖÖ. 1
string
ÖÖ2 8
(
ÖÖ8 9
productC
ÖÖ9 A
)
ÖÖA B
}
ÖÖB C
"
ÖÖC D
)
ÖÖD E
;
ÖÖE F
sb
ÜÜ 
.
ÜÜ 

AppendLine
ÜÜ 
(
ÜÜ 
$"
ÜÜ 
ProductCodeID: 
ÜÜ +
{
ÜÜ+ ,
new
ÜÜ- 0
string
ÜÜ1 7
(
ÜÜ7 8
userFriendlyName
ÜÜ8 H
)
ÜÜH I
}
ÜÜI J
"
ÜÜJ K
)
ÜÜK L
;
ÜÜL M
sb
áá 
.
áá 

AppendLine
áá 
(
áá 
$"
áá  
UserFriendlyName: 
áá .
{
áá. /
new
áá0 3
string
áá4 :
(
áá: ;
userFriendlyName
áá; K
)
ááK L
}
ááL M
"
ááM N
)
ááN O
;
ááO P
sb
àà 
.
àà 

AppendLine
àà 
(
àà 
$"
àà &
UserFriendlyNameLength: 
àà 4
{
àà4 5$
UserFriendlyNameLength
àà6 L
}
ààL M
"
ààM N
)
ààN O
;
ààO P
sb
ââ 
.
ââ 

AppendLine
ââ 
(
ââ 
$"
ââ !
WeekOfManufacture: 
ââ /
{
ââ/ 0
WeekOfManufacture
ââ1 B
}
ââB C
"
ââC D
)
ââD E
;
ââE F
sb
ää 
.
ää 

AppendLine
ää 
(
ää 
$"
ää !
YearOfManufacture: 
ää /
{
ää/ 0
YearOfManufacture
ää1 B
}
ääB C
"
ääC D
)
ääD E
;
ääE F
return
åå 
sb
åå 
.
åå 
ToString
åå 
(
åå 
)
åå  
;
åå  !
}
çç 	
}
éé 
public
êê 

class
êê %
ScreenConnectionMonitor
êê (
{
ëë 
public
íí 
delegate
íí 
void
íí %
ScreenConnectionHandler
íí 4
(
íí4 5
)
íí5 6
;
íí6 7
public
ìì 
static
ìì %
ScreenConnectionHandler
ìì -'
OnScreenConnectionChanged
ìì. G
;
ììG H
public
ïï 
static
ïï 
void
ïï 
Start
ïï  
(
ïï  !
)
ïï! "
{
ññ 	
var
óó 
hwnd
óó 
=
óó 
new
óó !
WindowInteropHelper
óó .
(
óó. /
Application
óó/ :
.
óó: ;
Current
óó; B
.
óóB C

MainWindow
óóC M
)
óóM N
.
óóN O
EnsureHandle
óóO [
(
óó[ \
)
óó\ ]
;
óó] ^

HwndSource
òò 
source
òò 
=
òò 

HwndSource
òò  *
.
òò* +
FromHwnd
òò+ 3
(
òò3 4
hwnd
òò4 8
)
òò8 9
;
òò9 :
source
ôô 
.
ôô 
AddHook
ôô 
(
ôô 
new
ôô 
HwndSourceHook
ôô -
(
ôô- .
WndProc
ôô. 5
)
ôô5 6
)
ôô6 7
;
ôô7 8
}
öö 	
private
úú 
static
úú 
IntPtr
úú 
WndProc
úú %
(
úú% &
IntPtr
úú& ,
hwnd
úú- 1
,
úú1 2
int
úú3 6
msg
úú7 :
,
úú: ;
IntPtr
úú< B
wParam
úúC I
,
úúI J
IntPtr
úúK Q
lParam
úúR X
,
úúX Y
ref
úúZ ]
bool
úú^ b
handled
úúc j
)
úúj k
{
ùù 	
const
ûû 
uint
ûû 
WM_DISPLAYCHANGE
ûû '
=
ûû( )
$num
ûû* 0
;
ûû0 1
switch
†† 
(
†† 
(
†† 
uint
†† 
)
†† 
msg
†† 
)
†† 
{
°° 
case
¢¢ 
WM_DISPLAYCHANGE
¢¢ %
:
¢¢% &'
OnScreenConnectionChanged
§§ -
?
§§- .
.
§§. /
Invoke
§§/ 5
(
§§5 6
)
§§6 7
;
§§7 8
break
•• 
;
•• 
}
¨¨ 
return
ÆÆ 
IntPtr
ÆÆ 
.
ÆÆ 
Zero
ÆÆ 
;
ÆÆ 
}
ØØ 	
}
∞∞ 
public
≥≥ 

class
≥≥ 

NativeInfo
≥≥ 
{
¥¥ 
public
µµ 
static
µµ 
List
µµ 
<
µµ 
DisplayDetails
µµ )
>
µµ) *
GetDisplaysInfo
µµ+ :
(
µµ: ;
)
µµ; <
{
∂∂ 	
var
∑∑ 
list
∑∑ 
=
∑∑ 
new
∑∑ 
List
∑∑ 
<
∑∑  
DisplayDetails
∑∑  .
>
∑∑. /
(
∑∑/ 0
)
∑∑0 1
;
∑∑1 2
DisplayDevice
∏∏ 
d
∏∏ 
=
∏∏ 
new
∏∏ !
DisplayDevice
∏∏" /
(
∏∏/ 0
)
∏∏0 1
;
∏∏1 2
d
ππ 
.
ππ 
cb
ππ 
=
ππ 
Marshal
ππ 
.
ππ 
SizeOf
ππ !
(
ππ! "
d
ππ" #
)
ππ# $
;
ππ$ %
try
∫∫ 
{
ªª 
for
ºº 
(
ºº 
uint
ºº 
id
ºº 
=
ºº 
$num
ºº  
;
ºº  !
NativeMethods
ºº" /
.
ºº/ 0 
EnumDisplayDevices
ºº0 B
(
ººB C
null
ººC G
,
ººG H
id
ººI K
,
ººK L
ref
ººM P
d
ººQ R
,
ººR S
$num
ººT U
)
ººU V
;
ººV W
id
ººX Z
++
ººZ \
)
ºº\ ]
{
ΩΩ 
if
ææ 
(
ææ 
d
ææ 
.
ææ 

StateFlags
ææ $
.
ææ$ %
HasFlag
ææ% ,
(
ææ, -%
DisplayDeviceStateFlags
ææ- D
.
ææD E
AttachedToDesktop
ææE V
)
ææV W
)
ææW X
{
øø 
var
¿¿ 
	isPrimary
¿¿ %
=
¿¿& '
d
¿¿( )
.
¿¿) *

StateFlags
¿¿* 4
.
¿¿4 5
HasFlag
¿¿5 <
(
¿¿< =%
DisplayDeviceStateFlags
¿¿= T
.
¿¿T U
PrimaryDevice
¿¿U b
)
¿¿b c
;
¿¿c d
Trace
¬¬ 
.
¬¬ 
	WriteLine
¬¬ '
(
¬¬' (
String
¬¬( .
.
¬¬. /
Format
¬¬/ 5
(
¬¬5 6
$str
¬¬6 T
,
¬¬T U
id
√√% '
,
√√' (
d
ƒƒ% &
.
ƒƒ& '

DeviceName
ƒƒ' 1
,
ƒƒ1 2
d
≈≈% &
.
≈≈& '
DeviceString
≈≈' 3
,
≈≈3 4
d
∆∆% &
.
∆∆& '

StateFlags
∆∆' 1
,
∆∆1 2
d
««% &
.
««& '
DeviceID
««' /
,
««/ 0
d
»»% &
.
»»& '
	DeviceKey
»»' 0
)
……% &
)
……& '
;
……' (
d
   
.
   
cb
   
=
   
Marshal
   &
.
  & '
SizeOf
  ' -
(
  - .
d
  . /
)
  / 0
;
  0 1
NativeMethods
ÃÃ %
.
ÃÃ% & 
EnumDisplayDevices
ÃÃ& 8
(
ÃÃ8 9
d
ÃÃ9 :
.
ÃÃ: ;

DeviceName
ÃÃ; E
,
ÃÃE F
$num
ÃÃG H
,
ÃÃH I
ref
ÃÃJ M
d
ÃÃN O
,
ÃÃO P
$num
ÃÃQ R
)
ÃÃR S
;
ÃÃS T
Trace
ŒŒ 
.
ŒŒ 
	WriteLine
ŒŒ '
(
ŒŒ' (
String
ŒŒ( .
.
ŒŒ. /
Format
ŒŒ/ 5
(
ŒŒ5 6
$str
ŒŒ6 @
,
ŒŒ@ A
d
ŒŒB C
.
ŒŒC D

DeviceName
ŒŒD N
,
ŒŒN O
d
ŒŒP Q
.
ŒŒQ R
DeviceString
ŒŒR ^
)
ŒŒ^ _
)
ŒŒ_ `
;
ŒŒ` a
list
–– 
.
–– 
Add
––  
(
––  !
new
––! $
DisplayDetails
––% 3
{
—— 
DeviceID
““ $
=
““% &
d
““' (
.
““( )
DeviceID
““) 1
,
““1 2
	DeviceKey
”” %
=
””& '
d
””( )
.
””) *
	DeviceKey
””* 3
,
””3 4

DeviceName
‘‘ &
=
‘‘' (
d
‘‘) *
.
‘‘* +

DeviceName
‘‘+ 5
,
‘‘5 6
DeviceString
’’ (
=
’’) *
d
’’+ ,
.
’’, -
DeviceString
’’- 9
,
’’9 :
	IsPrimary
÷÷ %
=
÷÷& '
	isPrimary
÷÷( 1
}
◊◊ 
)
◊◊ 
;
◊◊ 
}
ÿÿ 
d
⁄⁄ 
.
⁄⁄ 
cb
⁄⁄ 
=
⁄⁄ 
Marshal
⁄⁄ "
.
⁄⁄" #
SizeOf
⁄⁄# )
(
⁄⁄) *
d
⁄⁄* +
)
⁄⁄+ ,
;
⁄⁄, -
}
€€ 
}
‹‹ 
catch
›› 
(
›› 
	Exception
›› 
ex
›› 
)
››  
{
ﬁﬁ 
Trace
ﬂﬂ 
.
ﬂﬂ 
	WriteLine
ﬂﬂ 
(
ﬂﬂ  
String
ﬂﬂ  &
.
ﬂﬂ& '
Format
ﬂﬂ' -
(
ﬂﬂ- .
$str
ﬂﬂ. 3
,
ﬂﬂ3 4
ex
ﬂﬂ5 7
.
ﬂﬂ7 8
ToString
ﬂﬂ8 @
(
ﬂﬂ@ A
)
ﬂﬂA B
)
ﬂﬂB C
)
ﬂﬂC D
;
ﬂﬂD E
throw
‡‡ 
;
‡‡ 
}
‚‚ 
Trace
„„ 
.
„„ 
	WriteLine
„„ 
(
„„ 
JsonSerializer
„„ *
.
„„* +
	Serialize
„„+ 4
(
„„4 5
list
„„5 9
)
„„9 :
)
„„: ;
;
„„; <
return
‰‰ 
list
‰‰ 
;
‰‰ 
}
ÂÂ 	
}
ÊÊ 
[
ËË 
Flags
ËË 

(
ËË
 
)
ËË 
]
ËË 
internal
ÈÈ 
enum
ÈÈ %
DisplayDeviceStateFlags
ÈÈ )
:
ÈÈ* +
int
ÈÈ, /
{
ÍÍ 
AttachedToDesktop
ÏÏ 
=
ÏÏ 
$num
ÏÏ 
,
ÏÏ  
MultiDriver
ÌÌ 
=
ÌÌ 
$num
ÌÌ 
,
ÌÌ 
PrimaryDevice
ÔÔ 
=
ÔÔ 
$num
ÔÔ 
,
ÔÔ 
MirroringDriver
ÒÒ 
=
ÒÒ 
$num
ÒÒ 
,
ÒÒ 
VGACompatible
ÛÛ 
=
ÛÛ 
$num
ÛÛ 
,
ÛÛ 
	Removable
ıı 
=
ıı 
$num
ıı 
,
ıı 
ModesPruned
˜˜ 
=
˜˜ 
$num
˜˜ 
,
˜˜  
Remote
¯¯ 
=
¯¯ 
$num
¯¯ 
,
¯¯ 

Disconnect
˘˘ 
=
˘˘ 
$num
˘˘ 
}
˙˙ 
internal
¸¸ 
class
¸¸ 
NativeMethods
¸¸  
{
˝˝ 
[
˛˛ 	
	DllImport
˛˛	 
(
˛˛ 
$str
˛˛ 
)
˛˛  
]
˛˛  !
public
ˇˇ 
static
ˇˇ 
extern
ˇˇ 
bool
ˇˇ ! 
EnumDisplayDevices
ˇˇ" 4
(
ˇˇ4 5
string
ˇˇ5 ;
lpDevice
ˇˇ< D
,
ˇˇD E
uint
ˇˇF J
iDevNum
ˇˇK R
,
ˇˇR S
ref
ˇˇT W
DisplayDevice
ˇˇX e
lpDisplayDevice
ˇˇf u
,
ˇˇu v
uint
ˇˇw {
dwFlagsˇˇ| É
)ˇˇÉ Ñ
;ˇˇÑ Ö
}
ÄÄ 
public
ÇÇ 

class
ÇÇ 
DisplayDetails
ÇÇ 
{
ÉÉ 
public
ÑÑ 
string
ÑÑ 

DeviceName
ÑÑ  
;
ÑÑ  !
public
ÜÜ 
string
ÜÜ 
DeviceString
ÜÜ "
;
ÜÜ" #
public
àà 
string
àà 
DeviceID
àà 
;
àà 
public
ää 
string
ää 
	DeviceKey
ää 
;
ää  
public
åå 
bool
åå 
	IsPrimary
åå 
;
åå 
}
çç 
[
èè 
StructLayout
èè 
(
èè 

LayoutKind
èè 
.
èè 

Sequential
èè '
,
èè' (
CharSet
èè) 0
=
èè1 2
CharSet
èè3 :
.
èè: ;
Ansi
èè; ?
)
èè? @
]
èè@ A
internal
êê 
struct
êê 
DisplayDevice
êê !
{
ëë 
[
íí 	
	MarshalAs
íí	 
(
íí 
UnmanagedType
íí  
.
íí  !
U4
íí! #
)
íí# $
]
íí$ %
public
ìì 
int
ìì 
cb
ìì 
;
ìì 
[
ïï 	
	MarshalAs
ïï	 
(
ïï 
UnmanagedType
ïï  
.
ïï  !
	ByValTStr
ïï! *
,
ïï* +
	SizeConst
ïï, 5
=
ïï6 7
$num
ïï8 :
)
ïï: ;
]
ïï; <
public
ññ 
string
ññ 

DeviceName
ññ  
;
ññ  !
[
òò 	
	MarshalAs
òò	 
(
òò 
UnmanagedType
òò  
.
òò  !
	ByValTStr
òò! *
,
òò* +
	SizeConst
òò, 5
=
òò6 7
$num
òò8 ;
)
òò; <
]
òò< =
public
ôô 
string
ôô 
DeviceString
ôô "
;
ôô" #
[
õõ 	
	MarshalAs
õõ	 
(
õõ 
UnmanagedType
õõ  
.
õõ  !
U4
õõ! #
)
õõ# $
]
õõ$ %
public
úú %
DisplayDeviceStateFlags
úú &

StateFlags
úú' 1
;
úú1 2
[
ûû 	
	MarshalAs
ûû	 
(
ûû 
UnmanagedType
ûû  
.
ûû  !
	ByValTStr
ûû! *
,
ûû* +
	SizeConst
ûû, 5
=
ûû6 7
$num
ûû8 ;
)
ûû; <
]
ûû< =
public
üü 
string
üü 
DeviceID
üü 
;
üü 
[
°° 	
	MarshalAs
°°	 
(
°° 
UnmanagedType
°°  
.
°°  !
	ByValTStr
°°! *
,
°°* +
	SizeConst
°°, 5
=
°°6 7
$num
°°8 ;
)
°°; <
]
°°< =
public
¢¢ 
string
¢¢ 
	DeviceKey
¢¢ 
;
¢¢  
}
££ 
}§§ Ö)
XC:\Users\Nuke\Source\Repos\WpfApp1\WpfApp1\TestEntities\AcceleratorEnumeratingWindows.cs
	namespace 	
WpfApp1
 
. 
TestEntities 
{		 
class 	)
AcceleratorEnumeratingWindows
 '
{ 
internal 
delegate 
int 
EnumWindowsProc -
(- .
IntPtr. 4
hwnd5 9
,9 :
int; >
lParam? E
)E F
;F G
public 
static 
EnumWindowsProc %
OnWindowTriggered& 7
;7 8
private 
class 
UnManagedMethods &
{ 	
[ 
	DllImport 
( 
$str 
)  
]  !
public 
extern 
static  
int! $
EnumWindows% 0
(0 1
EnumWindowsProc 

lpEnumFunc  *
,* +
int 
lParam 
) 
; 
[ 
	DllImport 
( 
$str 
)  
]  !
public 
extern 
static  
int! $
EnumChildWindows% 5
(5 6
IntPtr 

hWndParent !
,! "
EnumWindowsProc 

lpEnumFunc  *
,* +
int 
lParam 
) 
; 
} 	
private"" !
EnumWindowsCollection"" %
items""& +
="", -
null"". 2
;""2 3
public** !
EnumWindowsCollection** $
Items**% *
{++ 	
get,, 
{-- 
return.. 
this.. 
... 
items.. !
;..! "
}// 
}00 	
public66 
void66 

GetWindows66 
(66 
)66  
{77 	
this88 
.88 
items88 
=88 
new88 !
EnumWindowsCollection88 2
(882 3
)883 4
;884 5
var99 
test99 
=99 
new99 
EnumWindowsProc99 *
(99* +
this99+ /
.99/ 0

WindowEnum990 :
)99: ;
;99; <
UnManagedMethods:: 
.:: 
EnumWindows:: (
(::( )
test::) -
,;; 
$num<< 
)<< 
;<< 
}== 	
publicDD 
voidDD 

GetWindowsDD 
(DD 
IntPtrEE 

hWndParentEE 
)EE 
{FF 	
thisGG 
.GG 
itemsGG 
=GG 
newGG !
EnumWindowsCollectionGG 2
(GG2 3
)GG3 4
;GG4 5
UnManagedMethodsHH 
.HH 
EnumChildWindowsHH -
(HH- .

hWndParentII 
,II 
newJJ 
EnumWindowsProcJJ #
(JJ# $
thisJJ$ (
.JJ( )

WindowEnumJJ) 3
)JJ3 4
,JJ4 5
$numKK 
)KK 
;KK 
}LL 	
privateVV 
intVV 

WindowEnumVV 
(VV 
IntPtrWW 
hWndWW 
,WW 
intXX 
lParamXX 
)XX 
{YY 	
ifZZ 
(ZZ 
thisZZ 
.ZZ 
OnWindowEnumZZ !
(ZZ! "
hWndZZ" &
)ZZ& '
)ZZ' (
{[[ 
return\\ 
$num\\ 
;\\ 
}]] 
else^^ 
{__ 
return`` 
$num`` 
;`` 
}aa 
}bb 	
	protectedpp 
virtualpp 
boolpp 
OnWindowEnumpp +
(pp+ ,
IntPtrpp, 2
hWndpp3 7
)pp7 8
{qq 	
itemsrr 
.rr 
Addrr 
(rr 
hWndrr 
)rr 
;rr 
returnss 
truess 
;ss 
}tt 	
publicww )
AcceleratorEnumeratingWindowsww ,
(ww, -
)ww- .
{xx 	
}zz 	
}|| 
public~~ 

class~~ !
EnumWindowsCollection~~ &
:~~' ("
ReadOnlyCollectionBase~~) ?
{ 
public
ÖÖ 
void
ÖÖ 
Add
ÖÖ 
(
ÖÖ 
IntPtr
ÖÖ 
wnd
ÖÖ "
)
ÖÖ" #
{
ÜÜ 	
this
áá 
.
áá 
	InnerList
áá 
.
áá 
Add
áá 
(
áá 
wnd
áá "
)
áá" #
;
áá# $
}
àà 	
public
çç 
IntPtr
çç 
this
çç 
[
çç 
int
çç 
index
çç $
]
çç$ %
{
éé 	
get
èè 
{
êê 
return
ëë 
(
ëë 
IntPtr
ëë 
)
ëë 
this
ëë #
.
ëë# $
	InnerList
ëë$ -
[
ëë- .
index
ëë. 3
]
ëë3 4
;
ëë4 5
}
íí 
}
ìì 	
public
òò #
EnumWindowsCollection
òò $
(
òò$ %
)
òò% &
{
ôô 	
}
õõ 	
}
úú 
}ùù µ6
FC:\Users\Nuke\Source\Repos\WpfApp1\WpfApp1\TestEntities\EnumWindows.cs
	namespace 	
WpfApp1
 
. 
TestEntities 
{ 
class		 	
EnumWindows		
 
{

 
[ 	
	DllImport	 
( 
$str 
)  
]  !
[ 	
return	 
: 
	MarshalAs 
( 
UnmanagedType (
.( )
Bool) -
)- .
]. /
private 
static 
extern 
bool "
IsWindowVisible# 2
(2 3
IntPtr3 9
hWnd: >
)> ?
;? @
[ 	
	DllImport	 
( 
$str 
,  

EntryPoint! +
=, -
$str. =
,= >
ExactSpelling 
= 
false 
, 
CharSet &
=' (
CharSet) 0
.0 1
Auto1 5
,5 6
SetLastError7 C
=D E
trueF J
)J K
]K L
private 
static 
extern 
int !
GetWindowText" /
(/ 0
IntPtr0 6
hWnd7 ;
,; <
StringBuilder 
lpWindowText &
,& '
int( +
	nMaxCount, 5
)5 6
;6 7
[ 	
	DllImport	 
( 
$str 
,  

EntryPoint! +
=, -
$str. B
,B C
ExactSpelling 
= 
false 
, 
CharSet &
=' (
CharSet) 0
.0 1
Auto1 5
,5 6
SetLastError7 C
=D E
trueF J
)J K
]K L
private 
static 
extern 
bool "
EnumDesktopWindows# 5
(5 6
IntPtr6 <
hDesktop= E
,E F
EnumDelegate "
lpEnumCallbackFunction /
,/ 0
IntPtr1 7
lParam8 >
)> ?
;? @
[ 	
	DllImport	 
( 
$str !
)! "
]" #
static 
extern 
uint 
GetLastError '
(' (
)( )
;) *
[ 	
	DllImport	 
( 
$str !
,! "
SetLastError# /
=0 1
true2 6
)6 7
]7 8
static 
extern 
int 
GetProcessId &
(& '
IntPtr' -
handle. 4
)4 5
;5 6
[ 	
	DllImport	 
( 
$str 
, 
SetLastError )
=* +
true, 0
)0 1
]1 2
static   
extern   
int   $
GetWindowThreadProcessId   2
(  2 3
IntPtr  3 9
hWnd  : >
,  > ?
out  @ C
int  D G
	processId  H Q
)  Q R
;  R S
private## 
delegate## 
bool## 
EnumDelegate## *
(##* +
IntPtr##+ 1
hWnd##2 6
,##6 7
int##8 ;
lParam##< B
)##B C
;##C D
private'' 
static'' 
List'' 
<'' 
IntPtr'' "
>''" #
WindowHandles''$ 1
;''1 2
private(( 
static(( 
List(( 
<(( 
string(( "
>((" #
WindowTitles(($ 0
;((0 1
public++ 
static++ 
void++ ,
 GetDesktopWindowHandlesAndTitles++ ;
(++; <
out,, 
List,, 
<,, 
IntPtr,, 
>,, 
handles,, $
,,,$ %
out,,& )
List,,* .
<,,. /
string,,/ 5
>,,5 6
titles,,7 =
),,= >
{-- 	
WindowHandles.. 
=.. 
new.. 
List..  $
<..$ %
IntPtr..% +
>..+ ,
(.., -
)..- .
;... /
WindowTitles// 
=// 
new// 
List// #
<//# $
string//$ *
>//* +
(//+ ,
)//, -
;//- .
if11 
(11 
!11 
EnumDesktopWindows11 #
(11# $
IntPtr11$ *
.11* +
Zero11+ /
,11/ 0
FilterCallback111 ?
,11? @
IntPtr11A G
.11G H
Zero11H L
)11L M
)11M N
{22 
handles33 
=33 
null33 
;33 
titles44 
=44 
null44 
;44 
}55 
else66 
{77 
handles88 
=88 
WindowHandles88 '
;88' (
titles99 
=99 
WindowTitles99 %
;99% &
}:: 
};; 	
private?? 
static?? 
bool?? 
FilterCallback?? *
(??* +
IntPtr??+ 1
hWnd??2 6
,??6 7
int??8 ;
lParam??< B
)??B C
{@@ 	
StringBuilderBB 
sb_titleBB "
=BB# $
newBB% (
StringBuilderBB) 6
(BB6 7
$numBB7 ;
)BB; <
;BB< =
intCC 
lengthCC 
=CC 
GetWindowTextCC &
(CC& '
hWndCC' +
,CC+ ,
sb_titleCC- 5
,CC5 6
sb_titleCC7 ?
.CC? @
CapacityCC@ H
)CCH I
;CCI J
intDD 
aDD 
;DD $
GetWindowThreadProcessIdEE $
(EE$ %
hWndEE% )
,EE) *
outEE+ .
aEE/ 0
)EE0 1
;EE1 2
sb_titleFF 
.FF 
AppendFF 
(FF 
$"FF 
  PROCESS ID = FF -
{FF- .
aFF. /
}FF/ 0
"FF0 1
)FF1 2
;FF2 3
stringHH 
titleHH 
=HH 
sb_titleHH #
.HH# $
ToStringHH$ ,
(HH, -
)HH- .
;HH. /
ifMM 
(MM 
IsWindowVisibleMM 
(MM  
hWndMM  $
)MM$ %
&&MM& (
stringNN 
.NN 
IsNullOrEmptyNN $
(NN$ %
titleNN% *
)NN* +
==NN, .
falseNN/ 4
)NN4 5
{OO 
WindowHandlesPP 
.PP 
AddPP !
(PP! "
hWndPP" &
)PP& '
;PP' (
WindowTitlesQQ 
.QQ 
AddQQ  
(QQ  !
titleQQ! &
)QQ& '
;QQ' (
}RR 
returnVV 
trueVV 
;VV 
}WW 	
}XX 
}YY 